<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Actualizador de Imágenes de Servicios</title>
    <!-- We'll use the JSZip library to create the zip file -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.0/FileSaver.min.js"></script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; line-height: 1.6; color: #333; max-width: 1200px; margin: 20px auto; padding: 0 20px; }
        h1, p { text-align: center; }
        .instructions { background-color: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 15px; margin-bottom: 25px; }
        .image-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 25px; }
        .image-card { border: 1px solid #ddd; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .image-card h3 { margin-top: 0; text-align: center; }
        .previews { display: flex; gap: 10px; margin-bottom: 15px; }
        .previews div { flex: 1; text-align: center; }
        .previews img { max-width: 100%; height: 120px; object-fit: cover; border-radius: 4px; background-color: #eee; }
        .previews p { margin: 5px 0 0; font-size: 0.8em; font-weight: bold; }
        input[type="file"] { width: 100%; }
        .download-container { text-align: center; margin-top: 30px; }
        #downloadBtn { background-color: #28a745; color: white; border: none; padding: 15px 30px; border-radius: 5px; cursor: pointer; font-size: 1.2em; }
        #downloadBtn:hover { background-color: #218838; }
        #downloadBtn:disabled { background-color: #ccc; cursor: not-allowed; }
    </style>
</head>
<body>

    <h1>Actualizador de Imágenes de Servicios</h1>
    <div class="instructions">
        <p><strong>Cómo usar:</strong></p>
        <ol>
            <li>Para cada imagen, haz clic en "Choose File" y selecciona una nueva imagen JPG o PNG. Aparecerá una vista previa.</li>
            <li>Una vez que hayas seleccionado todas las imágenes que deseas reemplazar, haz clic en el botón "Descargar Imágenes como .zip".</li>
            <li>Un archivo llamado <code>servicios-images.zip</code> se guardará en tu computadora.</li>
            <li>Descomprime este archivo y usa su contenido para reemplazar las imágenes en el directorio <code>assets/servicios/</code> de tu proyecto.</li>
            <li>Confirma los cambios (commit) de las nuevas imágenes y despliega en Vercel.</li>
        </ol>
    </div>

    <div class="image-grid" id="imageGrid">
        <!-- Image cards will be generated by JavaScript -->
    </div>

    <div class="download-container">
        <button id="downloadBtn" disabled>Descargar Imágenes como .zip</button>
    </div>

    <script>
        const imageGrid = document.getElementById('imageGrid');
        const downloadBtn = document.getElementById('downloadBtn');
        const filesToZip = {};

        // Generate the 15 image upload cards
        for (let i = 1; i <= 15; i++) {
            const card = document.createElement('div');
            card.className = 'image-card';
            card.innerHTML = `
                <h3>Reemplazar ${i}.png</h3>
                <div class="previews">
                    <div>
                        <p>Actual</p>
                        <img src="assets/servicios/${i}.png" alt="Current image ${i}">
                    </div>
                    <div>
                        <p>Vista Previa</p>
                        <img id="preview${i}" src="assets/images/425x500.png" alt="Preview for image ${i}">
                    </div>
                </div>
                <input type="file" id="file${i}" data-index="${i}" accept=".png, .jpg, .jpeg">
            `;
            imageGrid.appendChild(card);
        }

        imageGrid.addEventListener('change', (event) => {
            if (event.target.type === 'file') {
                const input = event.target;
                const index = input.dataset.index;
                const preview = document.getElementById(`preview${index}`);
                const file = input.files[0];

                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        preview.src = e.target.result;
                    };
                    reader.readAsDataURL(file);

                    // Store the file object to be zipped later
                    filesToZip[index] = file;
                    
                    // Enable the download button if at least one file is selected
                    downloadBtn.disabled = false;
                }
            }
        });

        downloadBtn.addEventListener('click', () => {
            if (Object.keys(filesToZip).length === 0) {
                alert("Por favor, selecciona al menos una imagen para reemplazar.");
                return;
            }

            const zip = new JSZip();
            const promises = [];

            for (const index in filesToZip) {
                const file = filesToZip[index];
                // We force the name to be `${index}.png` regardless of original extension
                const newFileName = `${index}.png`; 
                promises.push(zip.file(newFileName, file));
            }

            Promise.all(promises).then(() => {
                zip.generateAsync({ type: "blob" }).then(content => {
                    saveAs(content, "servicios-images.zip");
                });
            });
        });
    </script>

</body>
</html>
